<section ng-controller="FreelancerRegistrationCtrl">
    <div ng-if="contentReady" class="container" ng-init="freelancer.type=freelancer.type || 'agency'">
        <h1 class="row text-center text-bold" ng-show="freelancer.type=='agency'">Agency Registration</h1>
        <h1 class="row text-center text-bold" ng-show="freelancer.type=='freelancer'">Freelancer Registration</h1>

        <div class="row">
            <div class="col-md-12">
                <md-radio-group ng-model="freelancer.type">
                    <md-radio-button value="agency" class="md-primary">Agency</md-radio-button>
                    <md-radio-button value="freelancer" >Freelancer</md-radio-button>
                </md-radio-group>
            </div>
        </div>

        <ul class="nav nav-tabs" ng-init="freelancer_area.activeTab='about'">
            <li ng-click="freelancer_area.activeTab = 'about'" ng-class="{active: freelancer_area.activeTab == 'about'}"><a href="">ABOUT</a></li>
            <li ng-click="freelancer_area.activeTab = 'expertise'" ng-class="{active: freelancer_area.activeTab == 'expertise'}"><a href="">EXPERTISE</a></li>
            <li ng-click="freelancer_area.activeTab = 'work'" ng-class="{active: freelancer_area.activeTab == 'work'}"><a href="">WORK</a></li>
            <li ng-click="freelancer_area.activeTab = 'contact'" ng-class="{active: freelancer_area.activeTab == 'contact'}"><a href="">CONTACT</a></li>
        </ul>

        <form name="aboutForm" ng-show="freelancer_area.activeTab == 'about'">
            <h3 class="text-bold">Freelancer Information</h3>

            <p>Please provide brief information</p>

            <div class="form-group" ng-class="{'has-error': submittedAbout && aboutForm.name.$invalid}">
                <md-input-container class="md-block">
                    <label>Name</label>
                    <input class="form-control" name="name" unique-name ng-model="freelancer.name" required>
                    <div ng-messages="submittedAbout && aboutForm.name.$invalid" ng-class="{'md-auto-hide': !submittedAbout}">
                        <div ng-show="submittedAbout && aboutForm.name.$error.unique" ng-message="unique">Name already is taken</div>
                        <div ng-show="submittedAbout && aboutForm.name.$error.required" ng-message="required">Name is required</div>
                    </div>
                </md-input-container>
            </div>

            <div class="form-group"
                 ng-class="{'has-error': submittedAbout && aboutForm.introduction.$invalid}">
                <md-input-container class="md-block">
                    <label>Provide a short introduction of you (10-15 words)</label>
                    <input class="form-control" name="introduction" ng-model="freelancer.introduction" required>

                    <div ng-messages="submittedAbout && aboutForm.introduction.$invalid" ng-class="{'md-auto-hide': !submittedAbout}">
                        <div ng-show="submittedAbout && aboutForm.introduction.$error.required" ng-message="required">Introduction of you is required</div>
                    </div>
                </md-input-container>
            </div>

            <div class="form-group"
                 ng-class="{'has-error': submittedAbout && aboutForm.description.$invalid}">
                <md-input-container class="md-block">
                    <label>Why should an organization pick you from many others?(your 200 words sales</label>
                    <input class="form-control" name="description" ng-model="freelancer.description" required>

                    <div ng-messages="submittedAbout && aboutForm.description.$invalid" ng-class="{'md-auto-hide': !submittedAbout}">
                        <div ng-show="submittedAbout && aboutForm.description.$error.required" ng-message="required">Required field</div>
                    </div>

                </md-input-container>
            </div>

            <div class="form-group">
                <md-input-container class="md-block" flex-gt-sm="" ng-class="{'has-error': submittedAbout && aboutForm.location.$invalid}">
                    <label>Choose location</label>
                    <md-select name="location" ng-model="freelancer.location" required>
                        <md-option ng-repeat="item in locations" value="{{item}}">
                            {{item}}
                        </md-option>
                    </md-select>
                    <div ng-messages="submittedAbout && aboutForm.location.$invalid" ng-class="{'md-auto-hide': !submittedAbout}">
                        <div ng-show="submittedAbout && aboutForm.location.$error.required" ng-message="required">Required field</div>
                    </div>
                </md-input-container>
            </div>

            <div class="form-group testDisplay">
                <md-input-container class="selectTerm" ng-class="{'has-error': submittedAbout && aboutForm.cities.$invalid}">
                    <label>Cities where you can service</label>
                    <md-select ng-model="freelancer.cities" name="cities" md-on-close="clearSearchTerm()"
                               data-md-container-class="selectdemoSelectHeader" multiple="" required>
                        <md-select-header class="demo-select-header">
                            <input ng-model="searchTerm" type="search" placeholder="Search for a cities.."
                                   class="demo-header-searchbox _md-text">
                        </md-select-header>
                        <md-optgroup label="locations">
                            <md-option ng-value="item" ng-repeat="item in locations | filter:$select.search ">
                                {{item}}
                            </md-option>
                        </md-optgroup>
                    </md-select>
                    <div ng-messages="submittedAbout && aboutForm.cities.$invalid" ng-class="{'md-auto-hide': !submittedAbout}">
                        <div ng-show="submittedAbout && aboutForm.cities.$error.required" ng-message="required">Required field</div>
                    </div>
                </md-input-container>
            </div>

            <div class="form-group">
                <md-input-container class="md-block" flex-gt-sm=""  ng-class="{'has-error': submittedAbout && aboutForm.experience.$invalid}">
                    <label>Years of Experience (in years)</label>
                    <md-select ng-model="freelancer.experience" name="experience" required>
                        <md-option ng-repeat="item in experience" value="{{item}}">
                            {{item}}
                        </md-option>
                    </md-select>
                    <div ng-messages="submittedAbout && aboutForm.experience.$invalid" ng-class="{'md-auto-hide': !submittedAbout}">
                        <div ng-show="submittedAbout && aboutForm.experience.$error.required" ng-message="required">Required field</div>
                    </div>
                </md-input-container>
            </div>
            <div class="form-group">
                <md-input-container class="selectTerm" ng-class="{'has-error': submittedAbout && aboutForm.service_providers.$invalid}">
                    <label>I want to register as a freelancer in</label>
                    <md-select ng-model="freelancer.service_providers" md-on-close="clearSearchTerm()"
                               data-md-container-class="selectdemoSelectHeader" name="service_providers" multiple required>
                        <md-select-header class="demo-select-header">
                            <input ng-model="searchTerm" type="search" placeholder="Search.."
                                   class="demo-header-searchbox _md-text">
                        </md-select-header>
                        <md-optgroup>
                            <md-option ng-value="item" ng-repeat="item in freelancerType | filter:$select.search ">
                                {{item}}
                            </md-option>
                        </md-optgroup>
                    </md-select>
                    <div ng-messages="submittedAbout && aboutForm.service_providers.$invalid" ng-class="{'md-auto-hide': !submittedAbout}">
                        <div ng-show="submittedAbout && aboutForm.service_providers.$error.required" ng-message="required">Required field</div>
                    </div>
                </md-input-container>
            </div>
           <md-button class="md-raised" ng-click="submittedAbout=true;aboutForm.$invalid ? scrollToErr() : freelancer_area.activeTab = 'expertise'"> NEXT </md-button>
        </form>
        <form name="expertiseForm" ng-show="freelancer_area.activeTab == 'expertise'">
            <h3 class="text-bold">Content Writing</h3>

            <p>Please provide information about the Content Writing services you offer</p>

            <div class="form-group">
                <md-input-container class="selectTerm">
                    <label>Industry Expertise (select top 5)</label>
                    <md-select ng-model="freelancer.industry_expertise" md-on-close="clearSearchTerm()"
                               data-md-container-class="selectdemoSelectHeader" multiple>
                        <md-select-header class="demo-select-header">
                            <input ng-model="searchTerm" type="search" placeholder="Search for a cities.."
                                   class="demo-header-searchbox _md-text">
                        </md-select-header>
                        <md-optgroup label="locations">
                            <md-option ng-value="item" ng-repeat="item in industry | filter:$select.search ">
                                {{item}}
                            </md-option>
                        </md-optgroup>
                    </md-select>
                </md-input-container>


            </div>

            <div class="form-group">

                <md-input-container class="selectTerm">
                    <label>Content Type</label>
                    <md-select ng-model="freelancer.content_type" md-on-close="clearSearchTerm()"
                               data-md-container-class="selectdemoSelectHeader" multiple="">
                        <md-select-header class="demo-select-header">
                            <input ng-model="searchTerm" type="search" placeholder="Search for a content type.."
                                   class="demo-header-searchbox _md-text">
                        </md-select-header>
                        <md-optgroup label="content_type">
                            <md-option ng-value="item" ng-repeat="item in content | filter:$select.search ">
                                {{item}}
                            </md-option>
                        </md-optgroup>
                    </md-select>
                </md-input-container>


            </div>

            <div class="form-group">
                <md-input-container class="selectTerm">
                    <label>Languages in which you write</label>
                    <md-select ng-model="freelancer.languages" md-on-close="clearSearchTerm()"
                               data-md-container-class="selectdemoSelectHeader" multiple="">
                        <md-select-header class="demo-select-header">
                            <input ng-model="searchTerm" type="search" placeholder="Search for a cities.."
                                   class="demo-header-searchbox _md-text">
                        </md-select-header>
                        <md-optgroup label="locations">
                            <md-option ng-value="item" ng-repeat="item in language | filter:$select.search">
                                {{item}}
                            </md-option>
                        </md-optgroup>
                    </md-select>
                </md-input-container>

            </div>

            <div class="form-group">
                <div>Please specify pricing for your services</div>
                <div class="row">
                    <div class="col-xs-3 paddingT20">
                        <md-checkbox ng-click="priceHour=false;service=false;freelancer.price.hour=''"
                                     ng-model="priceWord"
                                     class="md-warn">Rs. Per word
                        </md-checkbox>
                    </div>
                    <div class="col-xs-9">
                        <md-input-container class="md-block">
                            <input class='form-control' numbers-only ng-disabled="!priceWord"
                                   ng-init="priceWord=!!freelancer.price.word"
                                   ng-model="freelancer.price.word" aria-label="Price Word">

                        </md-input-container>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3 paddingT20">
                        <md-checkbox ng-click="freelancer.price.word = '';" ng-model="priceHour" class="md-warn">Rs. Per word
                        </md-checkbox>
                    </div>
                    <div class="col-xs-9">

                        <md-input-container class="md-block">
                            <input class='form-control' numbers-only ng-disabled="!priceHour"
                                   ng-init="priceHour=!!freelancer.price.hour"
                                   ng-model="freelancer.price.hour" aria-label="Price Hour">

                        </md-input-container>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-4">
                        <md-checkbox ng-model="addService" class="md-warn" ng-init="addService = !!freelancer.service_packages.length">
                            <span>Packaged Services(?)</span>
                        </md-checkbox>
                    </div>
                    <div class="col-xs-8">
                        <a class="pointer" ng-click="createPackage()">
                            Create Packages
                        </a>
                    </div>
                </div>
                <div class="row" ng-if="freelancer.service_packages.length">
                    <table class="table table-bordered table-striped">
                        <tr>
                            <td>Preview</td>
                            <td>Price</td>
                            <td>Title</td>
                            <td style="width: 100px">Action</td>
                        </tr>
                        <tr ng-repeat="elem in freelancer.service_packages">
                            <td><img style="max-height: 70px;" ng-if="elem.preview.url" ng-src="{{elem.preview.url}}"></td>
                            <td>{{elem.title}}</td>
                            <td>{{elem.pricing}}</td>
                            <td style="width: 100px">
                                <ng-md-icon icon="cancel" ng-click="delete_package(elem)" style="fill: red;cursor: pointer"></ng-md-icon>
                                <ng-md-icon icon="mode_edit" ng-click="editPackage(elem, $index);show.pkgModal=true" style="fill: #63acff;cursor: pointer"></ng-md-icon>
                            </td>
                        </tr>

                    </table>

                </div>
            </div>

            <div class="row">
                <div class="col-md-6 text-left">
                    <md-button class="md-raised" ng-click="freelancer_area.activeTab='about'"> PREVIOUS </md-button>
                </div>
                <div class="col-md-6 text-right">
                    <md-button class="md-raised" ng-click="submittedExpertise=true;expertiseForm.$invalid ? scrollToErr() : freelancer_area.activeTab = 'work'"> NEXT </md-button>
                </div>
            </div>


        </form>
        <form name="workForm" ng-show="freelancer_area.activeTab == 'work'" novalidate>
            <h3 class="text-bold">Work</h3>

            <p>Enter information about your past work</p>

            <div class="form-group"
                 ng-class="{'has-error': submittedWork && workForm.customers.$invalid}">
                <md-input-container class="md-block">
                    <label>Number of Customers</label>
                    <input class='form-control' name="customers" numbers-only ng-model="freelancer.work.customers">
            </div>
            <div class="form-group"
                 ng-class="{'has-error': submittedWork && workForm.past_client.$invalid}">

                <md-input-container class="md-block">
                    <label>Past Clients that you have worked with</label>
                    <input class='form-control' name="past_client" ng-model="freelancer.work.past_client">
                </md-input-container>

            </div>
            <div class="form-group"
                 ng-class="{'has-error': submittedWork && workForm.testimonials.$invalid}">

                <md-input-container class="md-block">
                    <label>Client Testimonials (also mention the client name)</label>
                    <input class='form-control' name="testimonials" ng-model="freelancer.work.testimonials">
                </md-input-container>
            </div>
            <div class="form-group" ng-class="{'has-error': submittedWork && workForm.awards.$invalid}">
                <md-input-container class="md-block">
                    <label>Awards and Recognition</label>
                    <input class='form-control' name="awards" ng-model="freelancer.work.awards">
                </md-input-container>

            </div>
            <div class="form-group">
                <div class="text-right pointer" ngf-select="addWorkFiles($files)"  ngf-pattern="'image/*'" ngf-multiple="true">
                    <span style="font-size: 20px">Attach samples</span> <ng-md-icon icon="attach_file" style="fill: gray;" size="48"></ng-md-icon>
                </div>
                <div class="text-right">
                    <div class="row Files" ng-repeat="attach in freelancer.work.attachments">
                        <div class="col-xs-4 text-left">{{attach.url}}</div>
                        <div class="col-xs-8 floatR">
                            <img ngf-src="attach.url" ngf-thumbnail="attach.url" class="thumb">
                            <a href="" class="boxclose" ng-click="deleteWorkFile(attach._id);freelancer.work.attachments.splice($index,1);"></a>
                        </div>
                    </div>
                    <div class="row Files" ng-repeat="file in work_previews">
                        <div class="col-xs-4 text-left">{{file.name}}</div>
                        <div class="col-xs-8 floatR">
                            <img ngf-src="file" ngf-thumbnail="file" class="thumb">
                            <a href="" class="boxclose" ng-click="work_previews.splice($index,1)"></a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 text-left">
                    <md-button class="md-raised" ng-click="freelancer_area.activeTab='expertise'"> PREVIOUS </md-button>
                </div>
                <div class="col-md-6 text-right">
                    <md-button class="md-raised" ng-click="submittedWork=true;submitWork()"> NEXT </md-button>
                </div>
            </div>


        </form>
        <form name="contactForm" ng-show="freelancer_area.activeTab == 'contact'">
            <h3 class="text-bold">Contact Details</h3>

            <p>Please provide contact details at which marketers can contact you</p>

            <div class="form-group" ng-class="{'has-error': submittedContact && contactForm.contact_name.$invalid}">

                <md-input-container class="md-block">
                    <label>Contact Person Name</label>
                    <input class='form-control' name="contact_name" ng-model="freelancer.contact_detail.name" required>

                    <div ng-messages="submittedContact && contactForm.contact_name.$invalid" ng-class="{'md-auto-hide': !submittedContact}">
                        <div ng-show="submittedContact && contactForm.contact_name.$error.required" ng-message="required">Contact Person Name is required</div>
                    </div>
                </md-input-container>
            </div>
            <div class="form-group"
                 ng-class="{'has-error': submittedContact && contactForm.contact_email.$invalid}">
                <md-input-container class="md-block">
                    <label>Email ID at which marketers can contact you</label>
                    <input class='form-control' name="contact_email" ng-model="freelancer.contact_detail.email" required
                           ng-pattern='/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/'>
    `
                    <div ng-messages="submittedContact && contactForm.contact_name.$invalid" ng-class="{'md-auto-hide': !submittedContact}">
                        <div ng-show="submittedContact && contactForm.contact_email.$error.required" ng-message="required">Email ID is required</div>
                        <div ng-show="submittedContact && !contactForm.contact_email.$error.required && contactForm.contact_email.$error.pattern"
                             ng-message="pattern">Email ID is invalid</div>
                    </div>
                </md-input-container>
            </div>
            <div class="form-group"
                 ng-class="{'has-error': submittedContact && contactForm.contact_mobile.$invalid}">

                <md-input-container class="md-block">
                    <label>Mobile Number to send the contact request (will not be displayed)</label>
                    <input class='form-control' phone-number name="contact_mobile"
                           ng-model="freelancer.contact_detail.mobile"
                           required>

                    <div ng-messages="submittedContact && contactForm.contact_mobile.$invalid" ng-class="{'md-auto-hide': !submittedContact}">
                        <div ng-show="submittedContact && contactForm.contact_mobile.$error.required" ng-message="required">Mobile Number is required</div>
                    </div>

                </md-input-container>


            </div>
            <div class="text-right pointer" ng-click="show.profilePreview=true">
                <img ng-src="{{freelancer.contact_detail.preview}}" style="max-width: 70px" ng-if="freelancer.contact_detail.preview">
                <span style="font-size: 20px">Attach samples</span> <ng-md-icon icon="attach_file" style="fill: gray;" size="48"></ng-md-icon>
            </div>

            <div class="row">
                <div class="col-md-6 text-left">
                    <md-button class="md-raised" ng-click="freelancer_area.activeTab='work'"> PREVIOUS </md-button>
                </div>
                <div class="col-md-6 text-right">
                    <md-button class="md-raised" ng-click="submittedContact=true;addContactDetails(contactForm.$invalid)"> SUBMIT </md-button>
                </div>
            </div>
        </form>

    </div>

    <div ng-if="show.pkgModal" class="delete-modal-block">
        <div class="createPackage" ng-include="'template/freelancer_registration/create_package.html'"></div>
    </div>

    <div ng-if="show.profilePreview" class="delete-modal-block">
        <div class="createPackage">
            <form name="myForm">
                <fieldset ng-init="freelancer_area.profilePreview=freelancer.contact_detail.preview || ''">
                    <legend>Upload on form submit</legend>
                    <div ngf-drop ng-hide="freelancer_area.profilePreview" ngf-select="setProfileTempPreview($file)" class="drop-box">Drop</div>
                    <div style="width: 100%;height: 300px" ng-show="freelancer_area.profilePreview">
                        <img-crop area-type="square" image="freelancer_area.profilePreview" result-image="freelancer_area.croppedProfile">
                        </img-crop>
                    </div>
                    <div style="text-align: center;margin-top: 10px;">
                        <button class="btn btn-default" ng-click="freelancer_area.profilePreview='';">Upload New</button>
                        <button class="btn btn-default" ng-click="submitCropped(freelancer_area.croppedProfile)">Submit</button>
                        <button class="btn btn-default" ng-click="freelancer_area.croppedProfile='';show.profilePreview=false;">CANCEL</button>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>

    <script type="text/ng-template" id="attachFile">

        <form name="myForm">
            <fieldset>
                <legend>Upload on form submit</legend>
                <div class="testContainer">
                    <div ng-show="showDrop" ngf-drop ngf-select ng-model="picFile" class="drop-box">Drop</div>
                     <span class="progress" ng-show="picFile.progress >= 0">
                      <div style="width:{{picFile.progress}}%"
                           ng-bind="picFile.progress + '%'"></div>
                    </span>
                    <span ng-show="picFile.result">Upload Successful</span>
                </div>
                <i ng-show="myForm.file.$error.maxSize">File too large
                    {{errorFile.size / 1000000|number:1}}MB: max 2M</i>
                <span class="err" ng-show="errorMsg">{{errorMsg}}</span>
            </fieldset>
            <br>

        </form>

    </script>

    <script type="text/ng-template" id="has_sent">
        <div class="text-center">
            <h2 style="color: rgb(115, 160, 115);font-weight: bolder" class="text-center">Congratulations!</h2>
            <h3 style="color: rgb(115, 160, 115);" class="text-center">You registration request has been sent. We will notify you by email when admin approve your request!</h3>
            <button class="btn btn-default" ng-click="closeThisDialog()">Go to Home Page</button>
        </div>
    </script>
</section>